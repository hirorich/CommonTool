@startuml ConnectionControll.png

interface System.IDisposable {
  + {abstract} Dispose()
}

class DB.ConnectionManager {
  - {field} dbcontrollers:Dictionary(Of String, DB.ConnectionController)

  # New()
  # Add(dbname:String, controller:DB.ConnectionController):Boolean
  + Remove(dbname:String):Boolean
  + Exists(dbname:String):Boolean
  # CreateDbController(dbname:String):DB.ConnectionController
  + Dispose()
}
System.IDisposable <|.. DB.ConnectionManager

class DB.SqlManager {
  - {static} instance:DB.SqlManager

  - New()
  + {static} CreateInstance():DB.SqlManager
  + Add(dbname:String, connection:SqlConnection):Boolean
  + CreateDbController(dbname:String):DB.SqlController
}
DB.ConnectionManager <|-- DB.SqlManager

class DB.OleDbManager {
  - {static} instance:DB.OleDbManager

  - New()
  + {static} CreateInstance():DB.OleDbManager
  + Add(dbname:String, connection:OleDbConnection):Boolean
  + CreateDbController(dbname:String):DB.OleDbController
}
DB.ConnectionManager <|-- DB.OleDbManager

abstract class DB.ConnectionController {
  - dbname:String
  - connection:IDbConnection
  - transaction:IDbTransaction = Nothing

  # New(dbname:String, connection:IDbConnection)
  # {abstract} CreateDbDataAdapter():System.Data.Common.DbDataAdapter
  # {abstract} CreateIDbCommand():System.Data.IDbCommand
  + Open():Boolean
  + Close():Boolean
  + State():System.Data.ConnectionState
  + BeginTransaction():Boolean
  + Commit():Boolean
  + Rollback():Boolean
  # SearchRecord(query:String, Optional parameters:IDataParameterCollection):Datatable
  # UpdateRecord(query:String, Optional parameters:IDataParameterCollection):Integer
  - Prepare(query:String, Optional parameters:IDataParameterCollection):IDbCommand
  + Dispose()
}
System.IDisposable <|.. DB.ConnectionController

class DB.SqlController {

  ~ New(dbname:String, connection:SqlConnection)
  # CreateDbDataAdapter():System.Data.Common.DbDataAdapter
  # CreateIDbCommand():System.Data.IDbCommand
  + SelectRecord(query:String, Optional parameters:SqlParameterCollection):Datatable
  + UpdateRecord(query:String, Optional parameters:SqlParameterCollection):Integer
}
DB.ConnectionController <|-- DB.SqlController

class DB.OleDbController {

  ~ New(dbname:String, connection:OleDbConnection)
  # CreateDbDataAdapter():System.Data.Common.DbDataAdapter
  # CreateIDbCommand():System.Data.IDbCommand
  + SelectRecord(query:String, Optional parameters:OleDbParameterCollection):Datatable
  + UpdateRecord(query:String, Optional parameters:OleDbParameterCollection):Integer
}
DB.ConnectionController <|-- DB.OleDbController

DB.ConnectionManager "1" *-- "*" DB.ConnectionController

DB.SqlManager --> DB.SqlController:CreateDbController
DB.OleDbManager --> DB.OleDbController:CreateDbController

@enduml
