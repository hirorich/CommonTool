@startuml ConnectionControll.png

interface System.IDisposable {
  + {abstract} Dispose()
}

class System.Collections.Generic.Dictionary<TKey,TValue> {
  + {field} Item(TKey):TValue

  + New<TKey,TValue>()
  + Add(TKey, TValue)
  + Remove(TKey):Boolean
  + ContainsKey(TKey):Boolean
}

class DB.ConnectionManager {
  - {field} dbcontrollers:Dictionary(Of String, DB.ConnectionController)

  # New()
  # Add(dbname:String, controller:DB.ConnectionController):Boolean
  + Remove(dbname:String):Boolean
  + Exists(dbname:String):Boolean
  # CreateDbController(dbname:String):DB.ConnectionController
  + Dispose()
}
System.IDisposable <|.. DB.ConnectionManager

class DB.SqlManager {
  - {static} instance:DB.SqlManager

  - New()
  + {static} CreateInstance():DB.SqlManager
  + Add(dbname:String, connection:SqlConnection):Boolean
  + CreateDbController(dbname:String):DB.SqlController
}
DB.ConnectionManager <|-- DB.SqlManager

class DB.OleDbManager {
  - {static} instance:DB.OleDbManager

  - New()
  + {static} CreateInstance():DB.OleDbManager
  + Add(dbname:String, connection:OleDbConnection):Boolean
  + CreateDbController(dbname:String):DB.OleDbController
}
DB.ConnectionManager <|-- DB.OleDbManager

abstract class DB.ConnectionController {
  - connection:IDbConnection
  - transaction:IDbTransaction = Nothing

  # New(connection:IDbConnection)
  # {abstract} CreateDbDataAdapter():System.Data.Common.DbDataAdapter
  + Open():Boolean
  + Close():Boolean
  + State():System.Data.ConnectionState
  + BeginTransaction():Boolean
  + Commit():Boolean
  + Rollback():Boolean
  # SearchRecord(command:IDbCommand):Datatable
  # UpdateRecord(command:IDbCommand):Integer
  - Prepare(command:IDbCommand)
  + Dispose()
}
System.IDisposable <|.. DB.ConnectionController

class DB.SqlController {

  ~ New(connection:SqlConnection)
  # CreateDbDataAdapter():System.Data.Common.DbDataAdapter
  + SelectRecord(query:String):Datatable
  + SelectRecord(query:String, parameters:SqlParameterCollection):Datatable
  + UpdateRecord(query:String):Integer
  + UpdateRecord(query:String, parameters:SqlParameterCollection):Integer
}
DB.ConnectionController <|-- DB.SqlController

class DB.OleDbController {

  ~ New(connection:OleDbConnection)
  # CreateDbDataAdapter():System.Data.Common.DbDataAdapter
  + SelectRecord(query:String):Datatable
  + SelectRecord(query:String, parameters:OleDbParameterCollection):Datatable
  + UpdateRecord(query:String):Integer
  + UpdateRecord(query:String, parameters:OleDbParameterCollection):Integer
}
DB.ConnectionController <|-- DB.OleDbController

DB.ConnectionManager *-- System.Collections.Generic.Dictionary
DB.ConnectionManager "1" *-- "*" DB.ConnectionController

DB.SqlManager --> DB.SqlController:CreateDbController
DB.OleDbManager --> DB.OleDbController:CreateDbController

@enduml
