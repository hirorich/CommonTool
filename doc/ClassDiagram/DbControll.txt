@startuml DbControll.png
class DB.DbStrage {
  - {field} dbcontrollers:Dictionary(Of String, DB.DbController) = Nothing

  # {static} New()
  # Add(dbname:String, connection:IDbConnection):Boolean
  + Remove(dbname:String):Boolean
  + Exist(dbname:String):Boolean
  # CreateDbController(dbname:String):DB.DbController
}

class DB.SqlStrage {
  - {static} instance:DB.SqlStrage = Nothing

  - {static} New()
  + {static} CreateInstance():DB.SqlStrage
  + Add(dbname:String, connection:SqlConnection):Boolean
  + CreateDbController(dbname:String):DB.SqlController
}

class DB.OleDbStrage {
  - {static} instance:DB.OleDbStrage = Nothing

  - {static} New()
  + {static} CreateInstance():DB.OleDbStrage
  + Add(dbname:String, connection:OleDbConnection):Boolean
  + CreateDbController(dbname:String):DB.OleDbController
}

abstract class DB.DbController {
  - connection:IDbConnection = Nothing
  - transaction:IDbTransaction = Nothing

  # {static} New(connection:IDbConnection)
  # {abstract} NewDbDataAdapter():System.Data.Common.DbDataAdapter
  + Open():Boolean
  + Close():Boolean
  + State():System.Data.ConnectionState
  + BeginTransaction():Boolean
  + Commit():Boolean
  + Rollback():Boolean
  # SearchRecord(command:IDbCommand):Datatable
  # UpdateRecord(command:IDbCommand):Integer
}

class DB.SqlController {

  ~ {static} New(connection:SqlConnection)
  # NewDbDataAdapter():System.Data.Common.DbDataAdapter
  + Select(query:String):Datatable
  + Select(query:String, parameters:SqlParameterCollection):Datatable
  + Insert(query:String):Integer
  + Insert(query:String, parameters:SqlParameterCollection):Integer
  + Delete(query:String):Integer
  + Delete(query:String, parameters:SqlParameterCollection):Integer
  + Update(query:String):Integer
  + Update(query:String, parameters:SqlParameterCollection):Integer
}

class DB.OleDbController {

  ~ {static} New(connection:OleDbConnection)
  # NewDbDataAdapter():System.Data.Common.DbDataAdapter
  + Select(query:String):Datatable
  + Select(query:String, parameters:OleDbParameterCollection):Datatable
  + Insert(query:String):Integer
  + Insert(query:String, parameters:OleDbParameterCollection):Integer
  + Delete(query:String):Integer
  + Delete(query:String, parameters:OleDbParameterCollection):Integer
  + Update(query:String):Integer
  + Update(query:String, parameters:OleDbParameterCollection):Integer
}

DB.DbStrage <|-- DB.SqlStrage
DB.DbStrage <|-- DB.OleDbStrage
DB.DbController <|-- DB.SqlController
DB.DbController <|-- DB.OleDbController

DB.DbStrage "1" *-- "*" DB.DbController
DB.SqlStrage --> DB.SqlController:CreateDbController
DB.OleDbStrage --> DB.OleDbController:CreateDbController

@enduml
