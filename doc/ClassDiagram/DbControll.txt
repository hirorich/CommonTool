@startuml DbControll.png

interface System.IDisposable {
  + Dispose()
}

class DB.DbStrage {
  - {field} dbcontrollers:Dictionary(Of String, DB.DbController) = Nothing

  # {static} New()
  # Add(dbname:String, connection:IDbConnection):Boolean
  + Remove(dbname:String):Boolean
  + Exist(dbname:String):Boolean
  # CreateDbController(dbname:String):DB.DbController
  + Dispose()
}
System.IDisposable <|.. DB.DbStrage

class DB.SqlStrage {
  - {static} instance:DB.SqlStrage = Nothing

  - {static} New()
  + {static} CreateInstance():DB.SqlStrage
  + Add(dbname:String, connection:SqlConnection):Boolean
  + CreateDbController(dbname:String):DB.SqlController
}
DB.DbStrage <|-- DB.SqlStrage

class DB.OleDbStrage {
  - {static} instance:DB.OleDbStrage = Nothing

  - {static} New()
  + {static} CreateInstance():DB.OleDbStrage
  + Add(dbname:String, connection:OleDbConnection):Boolean
  + CreateDbController(dbname:String):DB.OleDbController
}
DB.DbStrage <|-- DB.OleDbStrage

abstract class DB.DbController {
  - connection:IDbConnection = Nothing
  - transaction:IDbTransaction = Nothing

  # {static} New(connection:IDbConnection)
  # {abstract} NewDbDataAdapter():System.Data.Common.DbDataAdapter
  + Open():Boolean
  + Close():Boolean
  + State():System.Data.ConnectionState
  + BeginTransaction():Boolean
  + Commit():Boolean
  + Rollback():Boolean
  # SearchRecord(command:IDbCommand):Datatable
  # UpdateRecord(command:IDbCommand):Integer
  + Dispose()
}
System.IDisposable <|.. DB.DbController

class DB.SqlController {

  ~ {static} New(connection:SqlConnection)
  # NewDbDataAdapter():System.Data.Common.DbDataAdapter
  + SelectData(query:String):Datatable
  + SelectData(query:String, parameters:SqlParameterCollection):Datatable
  + InsertData(query:String):Integer
  + InsertData(query:String, parameters:SqlParameterCollection):Integer
  + DeleteData(query:String):Integer
  + DeleteData(query:String, parameters:SqlParameterCollection):Integer
  + UpdateData(query:String):Integer
  + UpdateData(query:String, parameters:SqlParameterCollection):Integer
}
DB.DbController <|-- DB.SqlController

class DB.OleDbController {

  ~ {static} New(connection:OleDbConnection)
  # NewDbDataAdapter():System.Data.Common.DbDataAdapter
  + SelectData(query:String):Datatable
  + SelectData(query:String, parameters:OleDbParameterCollection):Datatable
  + InsertData(query:String):Integer
  + InsertData(query:String, parameters:OleDbParameterCollection):Integer
  + DeleteData(query:String):Integer
  + DeleteData(query:String, parameters:OleDbParameterCollection):Integer
  + UpdateData(query:String):Integer
  + UpdateData(query:String, parameters:OleDbParameterCollection):Integer
}
DB.DbController <|-- DB.OleDbController

DB.DbStrage "1" *-- "*" DB.DbController

DB.SqlStrage --> DB.SqlController:CreateDbController
DB.OleDbStrage --> DB.OleDbController:CreateDbController

@enduml
