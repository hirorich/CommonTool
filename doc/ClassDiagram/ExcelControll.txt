@startuml ExcelControll.png

interface System.IDisposable {
  + Dispose()
}

class System.Runtime.InteropServices.Marshal {
  + {static} IsComObject(Object):Boolean
  + {static} ReleaseComObject(Object):Integer
  + {static} FinalReleaseComObject(Object):Integer
}

class Excel.BookReader {
  - {static} instance:

  - New()
  + {static} CreateInstance():
  + CreateBook(filename:string):Excel.BookController
  + OpenBook(filename:string):Excel.BookController
  + CloseBook(Excel.BookController):Boolean
}

class Excel.BookController {
  - bookname:String = String.Empty
  - workbook:Microsoft.Office.Interop.Excel.Workbook = Nothing
  - worksheets:Microsoft.Office.Interop.Excel.Worksheets = Nothing
  - {field} sheetlist:ArrayList(Of Excel.SheetController) = Nothing
  
  ~ New(workbook:Microsoft.Office.Interop.Excel.Workbook)
  + SelectSheet(sheetname:String)Excel.SheetController
  + CreateSheet(sheetname:String):Boolean
  + DeleteSheet(sheetname:String):Boolean
  + CopySheet(sheet:Excel.SheetController, sheetname:String):Boolean
  + RenameSheet(sheetname:String):Boolean
  + ExistSheet(sheetname:String):Boolean
  + GetSheetNameList():List(Of String)
  + Dispose()
}
System.IDisposable <|.. Excel.BookController

class Excel.SheetController {
  - sheetname:String = String.Empty
  - worksheet:Microsoft.Office.Interop.Excel.Worksheet = Nothing
  
  ~ New(worksheet:Microsoft.Office.Interop.Excel.Worksheet)
  + Write(datatable:DataTable, rowstart:Integer, colstart:Integer, header:Boolean):Boolean
  + Write(dataview:DataView, rowstart:Integer, colstart:Integer, header:Boolean):Boolean
  + Write(text:String, rowno:Integer, colno:Integer):Boolean
  + Read(rowstart:Integer, colstart:Integer, rowend:Integer, colend:Integer, header:Boolean):DataTable
  + Read(rowno:Integer, colno:Integer):String
  + Dispose()
}
System.IDisposable <|.. Excel.SheetController

Excel.BookController *-- Excel.SheetController

Excel.BookController <-- Excel.BookReader:CreateBook
Excel.BookController <-- Excel.BookReader:OpenBook
System.Runtime.InteropServices.Marshal <-- Excel.BookController:Dispose
System.Runtime.InteropServices.Marshal <-- Excel.SheetController:Dispose

@enduml
